<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smooth Infinite Carousel</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 40px;
        }

        .carousel-wrap {
            position: relative;
            width: 100%;
            max-width: 780px;
            margin: auto;
        }

        .viewport {
            overflow: hidden;
            width: 100%;
        }

        .track {
            display: flex;
            transition: transform 0.35s ease;
        }

        .card {
            flex: 0 0 200px;
            height: 120px;
            background: #eee;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            user-select: none;
            margin: 10px;
        }

        .arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 42px;
            height: 42px;
            font-size: 24px;
            border: none;
            background: #ddd;
            cursor: pointer;
            border-radius: 4px;
        }

        .arrow.left {
            left: -60px;
        }

        .arrow.right {
            right: -60px;
        }
    </style>
</head>

<body>
    <h2>完全に滑らかな無限カルーセル✨</h2>

    <div class="carousel-wrap">
        <button class="arrow left" id="prevBtn">‹</button>

        <div class="viewport">
            <div class="track" id="track">
                <div class="card">1</div>
                <div class="card">2</div>
                <div class="card">3</div>
                <div class="card">4</div>
                <div class="card">5</div>
                <div class="card">6</div>
                <div class="card">7</div>
                <div class="card">8</div>
            </div>
        </div>

        <button class="arrow right" id="nextBtn">›</button>
    </div>

    <script>
        const track = document.getElementById("track");
        const cardWidth = track.children[0].offsetWidth + 20; // margin含む
        let isMoving = false;

        function move(dir) {
            if (isMoving) return;
            isMoving = true;

            track.style.transition = "transform 0.35s ease";
            track.style.transform = `translateX(${-dir * cardWidth}px)`;

            track.addEventListener('transitionend', handleEnd);

            function handleEnd() {
                track.style.transition = "none";
                track.style.transform = "translateX(0px)";

                if (dir === 1) {
                    track.appendChild(track.firstElementChild);
                } else {
                    track.insertBefore(track.lastElementChild, track.firstElementChild);
                }

                isMoving = false;
                track.removeEventListener('transitionend', handleEnd);
            }
        }

        document.getElementById("nextBtn").onclick = () => move(1);
        document.getElementById("prevBtn").onclick = () => move(-1);
    </script>
</body>

</html>